<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Price Analyzer - –ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω —Ç–æ–≤–∞—Ä–æ–≤</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <header class="header">
            <h1>ü§ñ AI Price Analyzer</h1>
            <p>–†–µ–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ü–µ–Ω —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ GPT API</p>
            <div class="status-panel">
                <span id="apiStatus" class="status error">API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</span>
                <span id="productCount" class="status info">–¢–æ–≤–∞—Ä–æ–≤: 0</span>
                <button id="voiceToggle" class="btn voice-btn">üé§ –ì–æ–ª–æ—Å</button>
            </div>
        </header>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="products">üìä –¢–æ–≤–∞—Ä—ã</button>
            <button class="nav-tab" data-tab="dialog">ü§ñ AI –î–∏–∞–ª–æ–≥</button>
            <button class="nav-tab" data-tab="history">üìã –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞</button>
            <button class="nav-tab" data-tab="settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button class="nav-tab" data-tab="logs">üîç –õ–æ–≥–∏</button>
        </nav>

        <!-- –í–∫–ª–∞–¥–∫–∞: –¢–æ–≤–∞—Ä—ã -->
        <div id="products" class="tab-content active">
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏ -->
            <div class="file-controls">
                <div class="import-section">
                    <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">
                    <button id="importBtn" class="btn primary">üì• –ò–º–ø–æ—Ä—Ç Excel/CSV</button>
                    <span id="importStatus"></span>
                </div>
                <div class="export-section">
                    <button id="exportExcel" class="btn success">üì§ –≠–∫—Å–ø–æ—Ä—Ç Excel</button>
                    <button id="exportCsv" class="btn outline">üìÑ –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                </div>
            </div>

            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ -->
            <div class="product-controls">
                <button id="addProduct" class="btn primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                <input type="text" id="searchProducts" placeholder="üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." class="search-input">
                <div class="bulk-actions">
                    <button id="selectAll" class="btn outline">‚òëÔ∏è –í—ã–±—Ä–∞—Ç—å –≤—Å–µ</button>
                    <button id="bulkCompetitorSearch" class="btn secondary" disabled>üîç –ù–∞–π—Ç–∏ —Ü–µ–Ω—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</button>
                    <button id="bulkAvitoSearch" class="btn secondary" disabled>üõí –ù–∞–π—Ç–∏ –±/—É –Ω–∞ Avito</button>
                </div>
            </div>

            <!-- –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
            <div class="table-container">
                <table id="productsTable" class="products-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAllCheckbox"></th>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</th>
                            <th>–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</th>
                            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                            <th>–¶–µ–Ω–∞ –∑–∞–∫—É–ø–∞</th>
                            <th>–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏</th>
                            <th>–¶–µ–Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ NEW</th>
                            <th>–¶–µ–Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –±/—É</th>
                            <th>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </tbody>
                </table>
                
                <div id="emptyState" class="empty-state">
                    <div class="empty-icon">üì¶</div>
                    <h3>–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</h3>
                    <p>–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ Excel/CSV —Ñ–∞–π–ª –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤—Ä—É—á–Ω—É—é</p>
                    <button id="addFirstProduct" class="btn primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä</button>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: AI –î–∏–∞–ª–æ–≥ -->
        <div id="dialog" class="tab-content">
            <div class="dialog-container">
                <div class="dialog-header">
                    <h3>ü§ñ AI –ê–≥–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ü–µ–Ω</h3>
                    <div class="voice-status" id="voiceStatus">–ì–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã</div>
                </div>

                <div class="dialog-messages" id="dialogMessages">
                    <div class="message system">
                        <div class="message-content">
                            <strong>–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!</strong><br>
                            –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
                            <ul>
                                <li>"–Ω–∞–π–¥–∏ —Ü–µ–Ω—É –Ω–∞ [—Ç–æ–≤–∞—Ä] —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤"</li>
                                <li>"–Ω–∞–π–¥–∏ –±/—É —Ü–µ–Ω—É –Ω–∞ [—Ç–æ–≤–∞—Ä]"</li>
                                <li>"–∏–∑–º–µ–Ω–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ [—Ç–æ–≤–∞—Ä] –Ω–∞ [—á–∏—Å–ª–æ]"</li>
                                <li>"—É—Å—Ç–∞–Ω–æ–≤–∏ —Ü–µ–Ω—É –ø—Ä–æ–¥–∞–∂–∏ [—Ç–æ–≤–∞—Ä] [—Ü–µ–Ω–∞]"</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="dialog-input">
                    <div class="input-container">
                        <textarea id="userInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è AI –∞–≥–µ–Ω—Ç–∞..." rows="3"></textarea>
                        <div class="input-actions">
                            <button id="voiceInput" class="btn voice">üé§</button>
                            <button id="sendMessage" class="btn primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ -->
        <div id="history" class="tab-content">
            <div class="history-container">
                <div class="history-header">
                    <h3>üìã –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞ —Ü–µ–Ω</h3>
                    <div class="history-controls">
                        <select id="historyFilter">
                            <option value="all">–í—Å–µ –ø–æ–∏—Å–∫–∏</option>
                            <option value="competitor">–¶–µ–Ω—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</option>
                            <option value="avito">Avito –±/—É</option>
                        </select>
                        <button id="clearHistory" class="btn outline">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                        <button id="exportHistory" class="btn outline">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
                    </div>
                </div>
                <div id="historyList" class="history-list">
                    <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div id="settings" class="tab-content">
            <div class="settings-container">
                <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                
                <!-- API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div class="settings-group">
                    <h4>üîë OpenAI API</h4>
                    <div class="form-group">
                        <label for="apiKey">API –ö–ª—é—á *</label>
                        <input type="password" id="apiKey" placeholder="sk-proj-..." required>
                        <small>–ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á –Ω–∞ <a href="https://platform.openai.com" target="_blank">platform.openai.com</a></small>
                    </div>
                    <div class="form-group">
                        <label for="gptModel">–ú–æ–¥–µ–ª—å GPT</label>
                        <select id="gptModel">
                            <option value="gpt-4o">GPT-4o (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                            <option value="gpt-4o-mini">GPT-4o Mini (—ç–∫–æ–Ω–æ–º–∏—á–Ω–∞—è)</option>
                            <option value="gpt-4">GPT-4</option>
                            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button id="testConnection" class="btn outline">üß™ –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</button>
                        <button id="saveApiSettings" class="btn primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ -->
                <div class="settings-group">
                    <h4>üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤</h4>
                    
                    <div class="form-group">
                        <label for="competitorPrompt">–ü—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤</label>
                        <textarea id="competitorPrompt" rows="4" placeholder="–ü—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ü–µ–Ω —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="avitoPrompt">–ü—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–∞ Avito</label>
                        <textarea id="avitoPrompt" rows="4" placeholder="–ü—Ä–æ–º–ø—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –±/—É —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ Avito..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="editPrompt">–ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</label>
                        <textarea id="editPrompt" rows="4" placeholder="–ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤..."></textarea>
                    </div>
                    
                    <button id="resetPrompts" class="btn outline">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –∫ —É–º–æ–ª—á–∞–Ω–∏—é</button>
                    <button id="savePrompts" class="btn primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã</button>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∞–º–∏ —Ç–∞–±–ª–∏—Ü—ã -->
                <div class="settings-group">
                    <h4>üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∞–º–∏ —Ç–∞–±–ª–∏—Ü—ã</h4>
                    <div id="columnsList" class="columns-list">
                        <!-- –°–ø–∏—Å–æ–∫ –∫–æ–ª–æ–Ω–æ–∫ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    <button id="addColumn" class="btn outline">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É</button>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –õ–æ–≥–∏ -->
        <div id="logs" class="tab-content">
            <div class="logs-container">
                <div class="logs-header">
                    <h3>üîç –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏</h3>
                    <div class="logs-controls">
                        <select id="logLevel">
                            <option value="all">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                            <option value="info">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</option>
                            <option value="success">–£—Å–ø–µ—Ö</option>
                            <option value="warning">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</option>
                            <option value="error">–û—à–∏–±–∫–∏</option>
                        </select>
                        <button id="clearLogs" class="btn outline">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                        <button id="exportLogs" class="btn outline">üì§ –≠–∫—Å–ø–æ—Ä—Ç</button>
                    </div>
                </div>
                <div id="logsList" class="logs-list">
                    <!-- –õ–æ–≥–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3>
            <form id="productForm">
                <div class="form-group">
                    <label for="productName">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-group">
                    <label for="productDescription">–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="productDescription" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="productQuantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
                        <input type="number" id="productQuantity" min="0">
                    </div>
                    <div class="form-group">
                        <label for="productPurchasePrice">–¶–µ–Ω–∞ –∑–∞–∫—É–ø–∞</label>
                        <input type="number" id="productPurchasePrice" step="0.01" min="0">
                    </div>
                    <div class="form-group">
                        <label for="productSalePrice">–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏</label>
                        <input type="number" id="productSalePrice" step="0.01" min="0">
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" id="cancelProduct" class="btn outline">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <div id="columnModal" class="modal">
        <div class="modal-content">
            <h3>–î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É</h3>
            <form id="columnForm">
                <div class="form-group">
                    <label for="columnName">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ *</label>
                    <input type="text" id="columnName" required>
                </div>
                <div class="form-group">
                    <label for="columnType">–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö</label>
                    <select id="columnType">
                        <option value="text">–¢–µ–∫—Å—Ç</option>
                        <option value="number">–ß–∏—Å–ª–æ</option>
                        <option value="currency">–í–∞–ª—é—Ç–∞</option>
                        <option value="date">–î–∞—Ç–∞</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="columnEditable" checked>
                        –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
                    </label>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                    <button type="button" id="cancelColumn" class="btn outline">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loadingIndicator" class="loading-indicator">
        <div class="spinner"></div>
        <div class="loading-text">–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...</div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notifications" class="notifications"></div>

    <script src="script.js"></script>
</body>
</html>